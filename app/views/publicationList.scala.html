@(paginatedPublications: models.api.PaginatedResult[models.api.PublicationWithEnaStudiesAndSampleCount], searchQuery: Option[String] = None)

@if(paginatedPublications.items.isEmpty) {
    <div class="alert alert-info" role="alert">
    @searchQuery match {
        case Some(q) => {
            No publications found matching "<strong>@q</strong>". Try a different search term.
        }
        case None => {
            No publications available.
        }
    }
    </div>
} else {
    <div id="publications-list">
    @for(details <- paginatedPublications.items) {
        @publicationDetails(details)
        <hr/>
    }
    </div>

    <div class="mt-2 d-flex justify-content-between align-items-center">
        <div>
            <label for="pageSizePublications">Items per page:</label>
            <select class="form-select form-select-sm d-inline-block w-auto" id="pageSizePublications"
            hx-get="@controllers.routes.PublicationController.getAllPublicationsWithDetailsHtml(Some(1), None, searchQuery)"
            hx-target="#publications-container"
            hx-swap="innerHTML"
            hx-trigger="change"
            hx-include="[name='pageSize']"
            name="pageSize">
                <option value="10" @if(paginatedPublications.pageSize == 10) { selected }>10</option>
                <option value="20" @if(paginatedPublications.pageSize == 20) { selected }>20</option>
                <option value="50" @if(paginatedPublications.pageSize == 50) { selected }>50</option>
                <option value="100" @if(paginatedPublications.pageSize == 100) { selected }>100</option>
            </select>
        </div>
        <div>
            <span class="text-muted me-2">@paginatedPublications.totalItems publications</span>
            @if(paginatedPublications.hasPreviousPage) {
                <button class="btn btn-outline-secondary btn-sm"
                hx-get="@controllers.routes.PublicationController.getAllPublicationsWithDetailsHtml(Some(paginatedPublications.currentPage - 1), Some(paginatedPublications.pageSize), searchQuery)"
                hx-target="#publications-container" hx-swap="innerHTML">
                    Previous
                </button>
            }
            <span class="mx-2">Page @paginatedPublications.currentPage of @paginatedPublications.totalPages</span>
            @if(paginatedPublications.hasNextPage) {
                <button class="btn btn-outline-secondary btn-sm"
                hx-get="@controllers.routes.PublicationController.getAllPublicationsWithDetailsHtml(Some(paginatedPublications.currentPage + 1), Some(paginatedPublications.pageSize), searchQuery)"
                hx-target="#publications-container" hx-swap="innerHTML">
                    Next
                </button>
            }
        </div>
    </div>
}

<script>
        document.addEventListener('DOMContentLoaded', function () {
            const pageSizeSelect = document.getElementById('pageSizePublications');
            if (pageSizeSelect) {
                pageSizeSelect.value = '@paginatedPublications.pageSize';
            }
        });
</script>
