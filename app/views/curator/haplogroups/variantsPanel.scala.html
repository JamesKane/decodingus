@import models.domain.genomics.VariantWithContig
@(haplogroupId: Int, variants: Seq[VariantWithContig])(implicit request: RequestHeader)

<h6 class="d-flex justify-content-between align-items-center">
    <span><i class="bi bi-code-square"></i> Defining Variants</span>
    <button type="button"
            class="btn btn-outline-primary btn-sm"
            data-bs-toggle="modal"
            data-bs-target="#variantSearchModal"
            hx-get="@controllers.routes.CuratorController.searchVariantsForHaplogroup(haplogroupId, None)"
            hx-target="#variant-search-content"
            hx-trigger="click">
        <i class="bi bi-plus"></i> Add
    </button>
</h6>

@if(variants.isEmpty) {
    <p class="text-muted small">No variants associated with this haplogroup.</p>
} else {
    <ul class="list-group list-group-flush small">
        @for(vwc <- variants) {
            <li class="list-group-item px-0 d-flex justify-content-between align-items-center">
                <div>
                    <strong>@vwc.variant.rsId.orElse(vwc.variant.commonName).getOrElse(s"ID: ${vwc.variant.variantId.get}")</strong>
                    <br>
                    <code class="small">@vwc.formattedPosition</code>
                    <span class="badge bg-info ms-1">@vwc.shortReferenceGenome</span>
                </div>
                <button type="button"
                        class="btn btn-outline-danger btn-sm"
                        hx-delete="@controllers.routes.CuratorController.removeVariantFromHaplogroup(haplogroupId, vwc.variant.variantId.get)"
                        hx-target="#variants-panel"
                        hx-confirm="Remove this variant from the haplogroup?">
                    <i class="bi bi-x"></i>
                </button>
            </li>
        }
    </ul>
}

<!-- Modal for variant search -->
<div class="modal fade" id="variantSearchModal" tabindex="-1" aria-labelledby="variantSearchModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="variantSearchModalLabel">Add Variant</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" id="variant-search-content">
                <!-- Content loaded via HTMX -->
                <div class="text-center py-3">
                    <div class="spinner-border spinner-border-sm" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
