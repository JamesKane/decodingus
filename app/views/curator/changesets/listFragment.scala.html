@import models.domain.haplogroups.{ChangeSetSummary, ChangeSetStatus}
@(changeSets: Seq[ChangeSetSummary], hgType: Option[String], status: Option[String], currentPage: Int, totalPages: Int, pageSize: Int)(implicit request: RequestHeader, messages: Messages)

@if(changeSets.isEmpty) {
    <div class="alert alert-info">
        <i class="bi bi-info-circle"></i> No change sets found matching your criteria.
        <p class="mb-0 mt-2 small">Change sets are created automatically when tree merge operations are performed.</p>
    </div>
} else {
    <div class="table-responsive">
        <table class="table table-hover">
            <thead>
                <tr>
                    <th>Name</th>
                    <th>Type</th>
                    <th>Status</th>
                    <th>Changes</th>
                    <th>Created</th>
                </tr>
            </thead>
            <tbody>
                @for(cs <- changeSets) {
                    <tr class="cursor-pointer"
                        hx-get="@controllers.routes.TreeVersioningCuratorController.changeSetDetailPanel(cs.id)"
                        hx-target="#detail-panel"
                        hx-swap="innerHTML"
                        style="cursor: pointer;">
                        <td>
                            <strong>@cs.name</strong>
                            <br><small class="text-muted">@cs.sourceName</small>
                        </td>
                        <td>
                            @views.html.fragments.badges.haplogroupType(cs.haplogroupType.toString)
                        </td>
                        <td>@views.html.fragments.badges.changeSetStatus(cs.status)</td>
                        <td>
                            <span title="Total changes">@cs.totalChanges</span>
                            @views.html.fragments.badges.pendingCount(cs.pendingChanges)
                        </td>
                        <td>
                            <small>@cs.createdAt.toLocalDate</small>
                            <br><small class="text-muted">by @cs.createdBy</small>
                        </td>
                    </tr>
                }
            </tbody>
        </table>
    </div>

    @views.html.fragments.pagination(
        currentPage,
        totalPages,
        (p: Int) => controllers.routes.TreeVersioningCuratorController.changeSetsFragment(hgType, status, p, pageSize),
        "#changesets-table",
        "#type-filter, #status-filter"
    )
}
