@import models.domain.genomics.{VariantWithContig, VariantGroup}
@import models.dal.domain.genomics.VariantAlias
@import models.domain.haplogroups.Haplogroup
@(vwc: VariantWithContig, variantGroup: Option[VariantGroup], aliases: Seq[VariantAlias], haplogroups: Seq[Haplogroup])(implicit request: RequestHeader, messages: Messages)

<div class="card">
    <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="mb-0">@vwc.variant.commonName.orElse(vwc.variant.rsId).getOrElse(s"Variant ${vwc.variant.variantId.get}")</h5>
        <span class="badge bg-secondary">@vwc.variant.variantType</span>
    </div>
    <div class="card-body">
        <dl class="row mb-0">
            <dt class="col-sm-4">@messages("variants.detail.rsId")</dt>
            <dd class="col-sm-8">
                @vwc.variant.rsId.map { rs =>
                    <a href="https://www.ncbi.nlm.nih.gov/snp/@rs" target="_blank" rel="noopener">@rs <i class="bi bi-box-arrow-up-right" style="font-size: 0.7rem;"></i></a>
                }.getOrElse("-")
            </dd>

            <dt class="col-sm-4">@messages("variants.detail.commonName")</dt>
            <dd class="col-sm-8">@vwc.variant.commonName.getOrElse("-")</dd>

            <dt class="col-sm-4">@messages("variants.detail.ancestral")</dt>
            <dd class="col-sm-8"><code>@vwc.variant.referenceAllele</code></dd>

            <dt class="col-sm-4">@messages("variants.detail.derived")</dt>
            <dd class="col-sm-8"><code>@vwc.variant.alternateAllele</code></dd>

            <dt class="col-sm-4">@messages("variants.detail.type")</dt>
            <dd class="col-sm-8">@vwc.variant.variantType</dd>
        </dl>

        @if(aliases.nonEmpty) {
            <hr>
            <h6><i class="bi bi-tags"></i> @messages("variants.detail.altNames")</h6>
            @views.html.components.variantAliases(aliases)
        }

        <hr>

        <h6><i class="bi bi-collection"></i> @messages("variants.detail.refBuilds")</h6>
        @views.html.components.variantBuilds(vwc, variantGroup)

        <hr>

        <h6><i class="bi bi-diagram-3"></i> @messages("variants.detail.usedBy")</h6>
        @if(haplogroups.isEmpty) {
            <p class="text-muted small">@messages("variants.detail.noHaplogroups")</p>
        } else {
            <div class="mb-3">
                @for(hg <- haplogroups.take(10)) {
                    @defining(if(hg.haplogroupType.toString == "Y") controllers.routes.TreeController.ytree(Some(hg.name)).url else controllers.routes.TreeController.mtree(Some(hg.name)).url) { treeUrl =>
                        <a href="@treeUrl"
                           class="badge @if(hg.haplogroupType.toString == "Y"){bg-primary}else{bg-success} text-decoration-none me-1">
                            @hg.name
                        </a>
                    }
                }
                @if(haplogroups.size > 10) {
                    <span class="text-muted small">+@(haplogroups.size - 10) @messages("variants.detail.more")</span>
                }
            </div>
        }
    </div>
</div>
